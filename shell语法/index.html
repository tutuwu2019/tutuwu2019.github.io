<!DOCTYPE html>
<html lang="en-US">

<head>
  <meta http-equiv="X-Clacks-Overhead" content="GNU Terry Pratchett" />
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="shortcut icon" href="https://tutuwu2019.github.io/images/favicon.png" />
<title>Shell语法 | 张不大的博客</title>
<meta name="title" content="Shell语法" />
<meta name="description" content="This is a page about »Shell语法«.
shell 语法 其实因该改成 shell 脚本语法
后来，我才发现原来很多越来越方便的语言(迎合人类习惯)的开发，就叫脚本语言开发。
比如 shell脚本、python脚本、js脚本、vim 脚本、lua脚本等等
shell脚本语法 像介绍其他开发语言一样，先介绍变量、常量、逻辑、if-else、循环(for、while)，再到 shell 脚本开发
变量、常量 逻辑(与/或/非) if-else 循环 for、while 脚本 词频统计 话说回来，shell 脚本好像把很多方法嵌入进入了，比如sort
# word.txt the day is sunny the the the sunny is is 首先切片 根据 空格、换行切片成若干个单词
cat ./word.txt | tr -s &rsquo; &rsquo; &lsquo;\n&rsquo;
再将切片后的单词排序 cat ./word.txt | tr -s &rsquo; &rsquo; &lsquo;\n&rsquo; | sort
再将单词去重 cat ./word.txt | tr -s &rsquo; &rsquo; &lsquo;\n&rsquo; | sort | uniq -c" />
<meta name="keywords" content="linux," />


<meta property="og:title" content="Shell语法" />
<meta property="og:description" content="This is a page about »Shell语法«.
shell 语法 其实因该改成 shell 脚本语法
后来，我才发现原来很多越来越方便的语言(迎合人类习惯)的开发，就叫脚本语言开发。
比如 shell脚本、python脚本、js脚本、vim 脚本、lua脚本等等
shell脚本语法 像介绍其他开发语言一样，先介绍变量、常量、逻辑、if-else、循环(for、while)，再到 shell 脚本开发
变量、常量 逻辑(与/或/非) if-else 循环 for、while 脚本 词频统计 话说回来，shell 脚本好像把很多方法嵌入进入了，比如sort
# word.txt the day is sunny the the the sunny is is 首先切片 根据 空格、换行切片成若干个单词
cat ./word.txt | tr -s &rsquo; &rsquo; &lsquo;\n&rsquo;
再将切片后的单词排序 cat ./word.txt | tr -s &rsquo; &rsquo; &lsquo;\n&rsquo; | sort
再将单词去重 cat ./word.txt | tr -s &rsquo; &rsquo; &lsquo;\n&rsquo; | sort | uniq -c" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://tutuwu2019.github.io/shell%E8%AF%AD%E6%B3%95/" /><meta property="og:image" content="https://tutuwu2019.github.io/images/share.png"/><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2024-08-14T01:20:35+08:00" />
<meta property="article:modified_time" content="2024-08-14T01:20:35+08:00" /><meta property="og:site_name" content="张不大的博客" />



<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://tutuwu2019.github.io/images/share.png"/>

<meta name="twitter:title" content="Shell语法"/>
<meta name="twitter:description" content="This is a page about »Shell语法«.
shell 语法 其实因该改成 shell 脚本语法
后来，我才发现原来很多越来越方便的语言(迎合人类习惯)的开发，就叫脚本语言开发。
比如 shell脚本、python脚本、js脚本、vim 脚本、lua脚本等等
shell脚本语法 像介绍其他开发语言一样，先介绍变量、常量、逻辑、if-else、循环(for、while)，再到 shell 脚本开发
变量、常量 逻辑(与/或/非) if-else 循环 for、while 脚本 词频统计 话说回来，shell 脚本好像把很多方法嵌入进入了，比如sort
# word.txt the day is sunny the the the sunny is is 首先切片 根据 空格、换行切片成若干个单词
cat ./word.txt | tr -s &rsquo; &rsquo; &lsquo;\n&rsquo;
再将切片后的单词排序 cat ./word.txt | tr -s &rsquo; &rsquo; &lsquo;\n&rsquo; | sort
再将单词去重 cat ./word.txt | tr -s &rsquo; &rsquo; &lsquo;\n&rsquo; | sort | uniq -c"/>



<meta itemprop="name" content="Shell语法">
<meta itemprop="description" content="This is a page about »Shell语法«.
shell 语法 其实因该改成 shell 脚本语法
后来，我才发现原来很多越来越方便的语言(迎合人类习惯)的开发，就叫脚本语言开发。
比如 shell脚本、python脚本、js脚本、vim 脚本、lua脚本等等
shell脚本语法 像介绍其他开发语言一样，先介绍变量、常量、逻辑、if-else、循环(for、while)，再到 shell 脚本开发
变量、常量 逻辑(与/或/非) if-else 循环 for、while 脚本 词频统计 话说回来，shell 脚本好像把很多方法嵌入进入了，比如sort
# word.txt the day is sunny the the the sunny is is 首先切片 根据 空格、换行切片成若干个单词
cat ./word.txt | tr -s &rsquo; &rsquo; &lsquo;\n&rsquo;
再将切片后的单词排序 cat ./word.txt | tr -s &rsquo; &rsquo; &lsquo;\n&rsquo; | sort
再将单词去重 cat ./word.txt | tr -s &rsquo; &rsquo; &lsquo;\n&rsquo; | sort | uniq -c"><meta itemprop="datePublished" content="2024-08-14T01:20:35+08:00" />
<meta itemprop="dateModified" content="2024-08-14T01:20:35+08:00" />
<meta itemprop="wordCount" content="1175"><meta itemprop="image" content="https://tutuwu2019.github.io/images/share.png"/>
<meta itemprop="keywords" content="linux," />
<meta name="referrer" content="no-referrer-when-downgrade" />

  <style>
  body {
    font-family: Verdana, sans-serif;
    margin: auto;
    padding: 20px;
    max-width: 720px;
    text-align: left;
    background-color: #fff;
    word-wrap: break-word;
    overflow-wrap: break-word;
    line-height: 1.5;
    color: #444;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6,
  strong,
  b {
    color: #222;
  }

  a {
    color: #3273dc;
     
  }

  .title {
    text-decoration: none;
    border: 0;
  }

  .title span {
    font-weight: 400;
  }

  nav a {
    margin-right: 10px;
  }

  textarea {
    width: 100%;
    font-size: 16px;
  }

  input {
    font-size: 16px;
  }

  content {
    line-height: 1.6;
  }

  table {
    width: 100%;
  }

  img {
    max-width: 100%;
  }

  code {
    padding: 2px 5px;
    background-color: #f2f2f2;
  }

  pre code {
    color: #222;
    display: block;
    padding: 20px;
    white-space: pre-wrap;
    font-size: 14px;
    overflow-x: auto;
  }

  div.highlight pre {
    background-color: initial;
    color: initial;
  }

  div.highlight code {
    background-color: unset;
    color: unset;
  }

  blockquote {
    border-left: 1px solid #999;
    color: #222;
    padding-left: 20px;
    font-style: italic;
  }

  footer {
    padding: 25px;
    text-align: center;
  }

  .helptext {
    color: #777;
    font-size: small;
  }

  .errorlist {
    color: #eba613;
    font-size: small;
  }

   
  ul.blog-posts {
    list-style-type: none;
    padding: unset;
  }

  ul.blog-posts li {
    display: flex;
  }

  ul.blog-posts li span {
    flex: 0 0 130px;
  }

  ul.blog-posts li a:visited {
    color: #8b6fcb;
  }

  @media (prefers-color-scheme: dark) {
    body {
      background-color: #333;
      color: #ddd;
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6,
    strong,
    b {
      color: #eee;
    }

    a {
      color: #8cc2dd;
    }

    code {
      background-color: #777;
    }

    pre code {
      color: #ddd;
    }

    blockquote {
      color: #ccc;
    }

    textarea,
    input {
      background-color: #252525;
      color: #ddd;
    }

    .helptext {
      color: #aaa;
    }
  }

</style>

</head>

<body>
  <header><a href="/" class="title">
  <h2>张不大的博客</h2>
</a>
<nav><a href="/">Home</a>

<a href="/about/">About</a>

<a href="/archive/archive/">Archive</a>


<a href="/blog">Blog</a>

</nav>
</header>
  <main>

<h1>Shell语法</h1>
<p>
  <i>
    <time datetime='2024-08-14' pubdate>
      14 Aug, 2024
    </time>
  </i>
</p>

<content>
  <p>This is a page about »Shell语法«.</p>
<h1 id="shell-语法">shell 语法</h1>
<blockquote>
<p>其实因该改成 shell 脚本语法</p>
</blockquote>
<blockquote>
<p>后来，我才发现原来很多越来越方便的语言(迎合人类习惯)的开发，就叫脚本语言开发。<br>
比如 shell脚本、python脚本、js脚本、vim 脚本、lua脚本等等</p>
</blockquote>
<h2 id="shell脚本语法">shell脚本语法</h2>
<p>像介绍其他开发语言一样，先介绍变量、常量、逻辑、if-else、循环(for、while)，再到 shell 脚本开发</p>
<h3 id="变量常量">变量、常量</h3>
<h3 id="逻辑与或非">逻辑(与/或/非)</h3>
<h3 id="if-else">if-else</h3>
<h3 id="循环-forwhile">循环 for、while</h3>
<h2 id="脚本">脚本</h2>
<h3 id="词频统计">词频统计</h3>
<blockquote>
<p>话说回来，shell 脚本好像把很多方法嵌入进入了，比如sort</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># word.txt</span>
</span></span><span style="display:flex;"><span>the day is sunny the the
</span></span><span style="display:flex;"><span>the sunny is is
</span></span></code></pre></div><ol>
<li>
<p>首先切片 根据 空格、换行切片成若干个单词</p>
<p>cat ./word.txt | tr -s &rsquo; &rsquo; &lsquo;\n&rsquo;</p>
</li>
<li>
<p>再将切片后的单词排序
cat ./word.txt | tr -s &rsquo; &rsquo; &lsquo;\n&rsquo; | sort</p>
</li>
<li>
<p>再将单词去重
cat ./word.txt | tr -s &rsquo; &rsquo; &lsquo;\n&rsquo; | sort | uniq -c</p>
</li>
<li>
<p>统计词频并逆序排列  (-nr 分别表示按照数字排序  逆序排序)
cat ./word.txt | tr -s &rsquo; &rsquo;  &lsquo;\n&rsquo; | sort | uniq -c | sort -nr</p>
</li>
<li>
<p>打印  按照  [单词  出现次数] 格式打印
cat ./word.txt | tr -s &rsquo; &rsquo; &lsquo;\n&rsquo; | sort | uniq -c |sort -nr | awk &lsquo;{print $2, $1}&rsquo;</p>
</li>
</ol>
<p><a href="https://github.com/tutuwu2019/hard-study-to-stronger/blob/main/linux/%E8%84%9A%E6%9C%AC/test/word_count.sh">demo</a></p>
<h3 id="打印有效电话号码-----xxx-xxx-xxxx-或-xxx-xxx-xxxxx-表示一个数字">打印有效电话号码     (xxx) xxx-xxxx 或 xxx-xxx-xxxx。（x 表示一个数字）</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># file.txt</span>
</span></span><span style="display:flex;"><span>987-123-4567
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">123</span> <span style="color:#ae81ff">456</span> <span style="color:#ae81ff">7890</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>123<span style="color:#f92672">)</span> 456-7890
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 正确格式的电话号码行如 （xxx) xxx-xxx</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 有固定的地方  左括号  右括号  空格  横杠</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 正则  </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#   ^ 表示开始</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#               () 需要转译 \( \) </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#         注意 横杠 - 是怎么样就是怎样，空格  是怎么样就是怎样   ([0-9]{3}-|\([0-9]{3}\) )  ==&gt; ([0-9]{3} - |\([0-9]{3}\) )  (在横杠前后加空格会比配成 &#34;空格-空格&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># $ 结束</span>
</span></span><span style="display:flex;"><span>awk <span style="color:#e6db74">&#39;/^([0-9]{3}-|\([0-9]{3}\) )[0-9]{3}-[0-9]{4}$/&#39;</span> file.txt
</span></span></code></pre></div><p>正则表达式补充</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Note 表含义中的出现次数：限定符前面字符的出现次数。
</span></span><span style="display:flex;"><span>限定符 | 表达含义 |
</span></span><span style="display:flex;"><span>-|-|-
</span></span><span style="display:flex;"><span>*| 出现次数 &gt;<span style="color:#f92672">=</span>0|
</span></span><span style="display:flex;"><span>+| 出现次数 &gt;<span style="color:#f92672">=</span>1|
</span></span><span style="display:flex;"><span>?| 出现次数 <span style="color:#ae81ff">0</span> or 1, 等价 <span style="color:#f92672">{</span>0,1<span style="color:#f92672">}</span>|
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>n<span style="color:#f92672">}</span>| 出现次数 <span style="color:#f92672">=</span> n|
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>n,<span style="color:#f92672">}</span>| 出现次数 &gt;<span style="color:#f92672">=</span>n|
</span></span><span style="display:flex;"><span><span style="color:#f92672">{</span>n, m<span style="color:#f92672">}</span>|n<span style="color:#f92672">=</span>&lt; 出现次数 &lt;<span style="color:#f92672">=</span> m|
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>定位符
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>定位符 | 表达含义 |
</span></span><span style="display:flex;"><span>-|-|-
</span></span><span style="display:flex;"><span>^| 字符串开始的位置 |
</span></span><span style="display:flex;"><span>$| 字符串结束的位置 |
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">\b</span> | 限定单词 <span style="color:#f92672">(</span>字<span style="color:#f92672">)</span> 的字符，常用来确定一个单词，可以结合两个‘<span style="color:#ae81ff">\b</span>’使用 |
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">\B</span> | 限定非单词 <span style="color:#f92672">(</span>字<span style="color:#f92672">)</span> 边界的字符，用的很少 |
</span></span></code></pre></div><h2 id="实用技能">实用技能</h2>
<h3 id="命令-echo">命令 echo</h3>
<p>携带参数</p>
<ol>
<li>-n 打印的文本末尾不换行(默认换行)</li>
<li>-e 表示转译 ，比如echo &ldquo;test\nthe new test&rdquo; 会进行 \n 转译</li>
<li>-E 禁用反斜杠转译 比如echo &ldquo;test\nthe new test&rdquo; 会进行 \n  ==&gt; 不会进行转译 不换换行</li>
</ol>
<h3 id="默认参数">默认参数</h3>
<ol>
<li>$# 传递脚本的参数个数或者传递函数的参数个数</li>
<li>$* 和 $@</li>
<li>$0 当前脚本或命令的名称</li>
<li>$1、$2、$3、&hellip; 表示传递的第几个参数 比如 $1 表述传递的第1个参数</li>
<li>$#</li>
<li>$$ 获取当前脚本执的进程号</li>
<li>$? 返回上一个命令执行的状态码</li>
<li>$! 最后一个后台运行的命令进程id</li>
<li>$_ 上一个命令的最后一个参数</li>
</ol>
<p><a href="https://github.com/tutuwu2019/hard-study-to-stronger/blob/main/linux/%E8%84%9A%E6%9C%AC/test/%E9%BB%98%E8%AE%A4%E5%8F%98%E9%87%8F.md">demo_test</a></p>
<h3 id="和-">[]、()、(())和 {}</h3>
<ol>
<li>[] 条件测试</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#用于比较字符串、文件属性  注意 condition 要与 &#39;[&#39; 和 &#39;]&#39; 要有空格   这是条件测试固有的要求</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 如</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> condition <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    xxx
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -f 检查是否是文件</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -f <span style="color:#e6db74">&#34;readme.md&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    xxx
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># -d 检查是否有目录</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -d <span style="color:#e6db74">&#34;~/xxxdirName&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    xxx
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 或者</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span> <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span>$VAR<span style="color:#e6db74">&#34;</span> -eq <span style="color:#ae81ff">0</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    xxx
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><ol start="2">
<li>() 子shell</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#比如 执行子命令 (command1; command2)</span>
</span></span><span style="display:flex;"><span>VAR<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> $VAR -eq <span style="color:#ae81ff">1</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">(</span>echo -e <span style="color:#e6db74">&#34;VAR: </span>$VAR<span style="color:#e6db74">\n&#34;</span>; echo -e <span style="color:#e6db74">&#34;else&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#还是可以定义数组</span>
</span></span><span style="display:flex;"><span>array_name<span style="color:#f92672">=(</span>value0 value1 value2 value3<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>array_name<span style="color:#f92672">=(</span>
</span></span><span style="display:flex;"><span>value0
</span></span><span style="display:flex;"><span>value1
</span></span><span style="display:flex;"><span>value2
</span></span><span style="display:flex;"><span>value3
</span></span><span style="display:flex;"><span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>array_name<span style="color:#f92672">[</span>0<span style="color:#f92672">]=</span>value0
</span></span><span style="display:flex;"><span>array_name<span style="color:#f92672">[</span>1<span style="color:#f92672">]=</span>value1
</span></span><span style="display:flex;"><span>array_name<span style="color:#f92672">[</span>2<span style="color:#f92672">]=</span>value2
</span></span></code></pre></div><ol start="3">
<li>
<p>(()) 进行算数运算的结构</p>
<p>((xxx))  xxx 表示进行算数运算。如((i+=20))  ==&gt; i=i+20
$((xxx)) 表示把xxx 的结果赋给变量</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>    <span style="color:#75715e">#!/bin/bash</span>
</span></span><span style="display:flex;"><span>    VAR<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> <span style="color:#f92672">((</span>i<span style="color:#f92672">=</span>1; i &lt; 10; i++<span style="color:#f92672">))</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">((</span>VAR<span style="color:#f92672">+=</span>i<span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">done</span>
</span></span></code></pre></div><ol start="4">
<li>{}
<blockquote>
<p>命令组  {} 内部放多个命令，在同一个环境中顺序执行
字符串扩展   注意会保留空格</p>
</blockquote>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>echo <span style="color:#f92672">{</span>a,b,c<span style="color:#f92672">}{</span>1,2,3<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#a1 a2 a3 b1 b2 b3 c1 c2 c3</span>
</span></span><span style="display:flex;"><span>echo -e <span style="color:#f92672">{</span>a,b,c<span style="color:#f92672">}{</span><span style="color:#e6db74">&#34; 1\t&#34;</span>,<span style="color:#e6db74">&#34; 2\t&#34;</span>,<span style="color:#e6db74">&#34; 3\t&#34;</span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#a 1      a 2     a 3     b 1     b 2     b 3     c 1     c 2     c 3</span>
</span></span><span style="display:flex;"><span>echo -e <span style="color:#f92672">{</span>a,b,c<span style="color:#f92672">}{</span><span style="color:#e6db74">&#34; 1&#34;</span>,<span style="color:#e6db74">&#34; 2&#34;</span>,<span style="color:#e6db74">&#34; 3&#34;</span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#a 1 a 2 a 3 b 1 b 2 b 3 c 1 c 2 c 3</span>
</span></span><span style="display:flex;"><span>echo -e <span style="color:#f92672">{</span>a,b,c<span style="color:#f92672">}{</span><span style="color:#e6db74">&#34;1\t&#34;</span>,<span style="color:#e6db74">&#34;2\t&#34;</span>,<span style="color:#e6db74">&#34;3\t&#34;</span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#a1       a2      a3      b1      b2      b3      c1      c2      c3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#内联代码块  </span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i in <span style="color:#f92672">{</span>1..5<span style="color:#f92672">}</span>; <span style="color:#f92672">{</span> echo <span style="color:#e6db74">&#34;Number: </span>$i<span style="color:#e6db74">&#34;</span>; <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#等价于</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i in <span style="color:#f92672">{</span>1..5<span style="color:#f92672">}</span>; 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">do</span> 
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;Number: </span>$i<span style="color:#e6db74">&#34;</span>; 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 函数定义</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>my_function<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;Hello from my_function&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>my_function
</span></span></code></pre></div><ol start="5">
<li>总结
<ol>
<li>区别</li>
</ol>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cat  ./tmp_0824_03.sh 
</span></span><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>VAR1<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;this is test&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>VAR2<span style="color:#f92672">=</span>$VAR1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>VAR3<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$VAR1<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>VAR4<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>VAR1<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo -e <span style="color:#e6db74">&#34;VAR1: </span>$VAR1<span style="color:#e6db74">\tVAR2:</span>$VAR2<span style="color:#e6db74">\tVAR3:</span>$VAR3<span style="color:#e6db74">\tVAR4:</span>$VAR4<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>./tmp_0824_03.sh 
</span></span><span style="display:flex;"><span>VAR1: this is test      VAR2:this is test       VAR3:this is test       VAR4:this is test
</span></span></code></pre></div><pre><code>2. 建议使用 &quot;$VAR1&quot; 而不是 $VAR1
    因为 &quot;$VAR1&quot; 表示的是一个整体，而且两者是数字(比如整数)的效果是等价的，而当表示字符串、空值会出现一些问题，比如  VAR1=“hello world&quot; --&gt;&quot;$VAR1&quot;表示 &quot;hello world&quot; 而 $VAR1表示 hello world 在执行  &quot;$VAR1&quot; -eq xxx 或者 $VAR1 -eq xxx 会报错(尽管都会报错)

    1. 举例说明
        &gt; var1=1
        &gt; [$var1 -eq 1] 和 [&quot;$var1&quot; -eq 1 ] 的区别
         1. [$var1 -eq 1]
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>    <span style="color:#75715e">#!/bin/bash</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#变量展开：这里 var1 被直接展开为其值。这个语法在变量 var1 不为空且值为整数时工作正常。</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#无引号：没有引号包裹变量，因此如果 var1 的值为空或包含空格，这种情况会引发错误或意外行为。</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#潜在风险：如果 var1 是空的或包含特殊字符（如空格），会导致语法错误。例如，[ -eq 1 ] 会导致错误。</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#比如 var1 是空 </span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    var1<span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> $var1 -eq <span style="color:#ae81ff">1</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;Variable equals 1&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;Variable does not equal 1&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#当 var1 为空时，[ $var1 -eq 1 ] 变成 [ -eq 1 ]   会报错：bash: [: -eq: unary operator expected</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#比如 var1 有空格</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    var1<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;some value&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> $var1 -eq <span style="color:#ae81ff">1</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;Variable equals 1&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;Variable does not equal 1&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#  问题: 当 var1 包含空格时，[ $var1 -eq 1 ] 会变成 [ some value -eq 1 ]。这将导致语法错误 bash: [: some: integer expression expected</span>
</span></span></code></pre></div><pre><code>         2. [&quot;$var1&quot; -eq 1 ]
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>    <span style="color:#75715e">#!/bin/bash</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#变量展开：&#34;$var1&#34; 通过引号包裹，因此变量的值会被正确处理，尤其是当变量包含空格或特殊字符时。</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#安全性：这种方式更安全，因为即使 var1 的值为空或包含空格，也不会导致语法错误。</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#推荐使用：使用引号包裹变量是一个好习惯，可以避免一些常见的错误和不期望的行为。</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#比如 var1 是空</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    var1<span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span>$var1<span style="color:#e6db74">&#34;</span> -eq <span style="color:#ae81ff">1</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;Variable equals 1&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;Variable does not equal 1&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#行为: 这个脚本不会出错，因为 &#34;$var1&#34; 被引号包裹。引号确保了即使变量为空，它也会被正确地处理为一个空字符串。</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#结果: Shell 会将空字符串与 1 比较，-eq 运算符只接受整数，所以结果会是一个错误（可能会输出 “Variable does not equal 1”）。但不会产生语法错误。</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#比如 var1 有空格</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    var1<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;some value&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span>$var1<span style="color:#e6db74">&#34;</span> -eq <span style="color:#ae81ff">1</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;Variable equals 1&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;Variable does not equal 1&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#行为: 即使引号包裹变量，&#34;$var1&#34; 仍然包含空格，这将导致一个错误：bash: [: some value: integer expression expected   注意啊，这种情况和 $var1 -eq 1 是等价的错误</span>
</span></span><span style="display:flex;"><span>    
</span></span></code></pre></div><pre><code>3. shell 中整数变量和字符串变量
   1. shell 提供了 ((xxx)) 用于整数计算，比如 
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>var1<span style="color:#f92672">=</span><span style="color:#ae81ff">21</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">((</span>$var1 -eq 22<span style="color:#f92672">))</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;var1==22&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span> 
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;var1!=22&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><pre><code>        逻辑比较 -eq (比较是否相等)、-ne (是否不相等)、-lt( less then 判断第一个整数是否小于第二个整数)、-le (判断第一个整数是否小于或等于第二个整数)、-gt (判断第一个整数是否大于第二个整数) 和 -ge (判断第一个整数是否大于或等于第二个整数)
    2. 字符串   字符串变量用于文本操作，包括拼接、比较和模式匹配。字符串操作通常使用 [ 或 [[ 进行
       1. 字符串拼接
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>first_name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;John&#34;</span>
</span></span><span style="display:flex;"><span>last_name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Doe&#34;</span>
</span></span><span style="display:flex;"><span>full_name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>first_name<span style="color:#e6db74">}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">${</span>last_name<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;Full Name: </span>$full_name<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>full_name_length<span style="color:#f92672">=</span><span style="color:#e6db74">${#</span>full_name<span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;full_name length is </span>$full_name_length<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#Full Name: John Doe</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#the full_name length is 8</span>
</span></span></code></pre></div><pre><code>        2. 字符串匹配
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>filename<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;report_2024.txt&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> <span style="color:#e6db74">&#34;</span>$filename<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">==</span> report_*.txt <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;The filename starts with &#39;report_&#39; and ends with &#39;.txt&#39;.&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;The filename does not match the pattern.&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><pre><code>        3. 计算字符串长度
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>text<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Hello, World!&#34;</span>
</span></span><span style="display:flex;"><span>text_length<span style="color:#f92672">=</span><span style="color:#e6db74">${#</span>text<span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">((</span> text_length &gt; <span style="color:#ae81ff">10</span> <span style="color:#f92672">))</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;The text is long.&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;The text is short.&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><pre><code>        4. 检查是否有 有效整数
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>input<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;100&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 检查字符串是否是有效整数</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> <span style="color:#e6db74">&#34;</span>$input<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">=</span>~ ^<span style="color:#f92672">[</span>0-9<span style="color:#f92672">]</span>+$ <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># 进行算术运算</span>
</span></span><span style="display:flex;"><span>    doubled<span style="color:#f92672">=</span><span style="color:#66d9ef">$((</span>input <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span><span style="color:#66d9ef">))</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;Doubled value: </span>$doubled<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;The input is not a valid integer.&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><pre><code>        5. 字符串切片
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>    string<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;alibaba is a great company&#34;</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">${</span>string:1:4<span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span>    liba
</span></span></code></pre></div><h3 id="重定向">重定向</h3>
<ol>
<li>&gt; 和 &raquo;</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># &gt; 会把内容重定向到新的地方，会覆盖原来已有的内容</span>
</span></span><span style="display:flex;"><span>cat record.log &gt; tmp.log
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># &gt;&gt; 会把内容重定向到新的地方，不会覆盖原来已有的内容</span>
</span></span><span style="display:flex;"><span>cat record.log &gt;&gt; tmp.log
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 注意 在使用 tcpdump 抓包 把抓包内容写入文件中采用的是 -w</span>
</span></span><span style="display:flex;"><span>tcpdump -vvv -n -i any 192.168.21.26 -w tmp.log
</span></span></code></pre></div><ol start="2">
<li>把标准输出、标准错误抛弃
有两种方式</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#1.</span>
</span></span><span style="display:flex;"><span>cat record.log  &amp;&gt; /dev/null
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#2. 这种方式更通用</span>
</span></span><span style="display:flex;"><span>cat record.log &gt; /dev/null 2&gt;&amp;<span style="color:#ae81ff">1</span>
</span></span></code></pre></div><h3 id="判断主机是否存在-xxx命令">判断主机是否存在 xxx命令</h3>
<p>command -v xxx</p>
<h3 id="正则表达式">正则表达式</h3>
<ol>
<li>模糊匹配</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># .*?</span>
</span></span></code></pre></div><p><a href="https://github.com/tutuwu2019/hard-study-to-stronger/blob/main/linux/%E6%AD%A3%E5%88%99%E5%8C%B9%E9%85%8D/tmp01.md">demo_01</a></p>
<h3 id="关于-脚本退出的状态码">关于 脚本退出的状态码</h3>
<blockquote>
<p>可以通过 $? 获取上一个命令结束的状态码</p>
<blockquote>
<p>默认正确执行命令结束状态码为 0，错误执行为 1， 2， 3 &hellip;
注意，在做 if 判断的时候 if ( command ); then  xxx  ; 如果正确执行会会执行 if 里面的语句命令 (尽管返回值是0，而错误结果返回值反而是非零 但是不能和逻辑 true 和 false 混淆)</p>
</blockquote>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./tmp_0825_03.sh
</span></span><span style="display:flex;"><span>exit 
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@localhost sh_<span style="color:#f92672">]</span><span style="color:#75715e"># echo &#34;$?&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@localhost sh_<span style="color:#f92672">]</span><span style="color:#75715e"># cat ./tmp_0825_03.sh </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;exit &#34;</span>
</span></span><span style="display:flex;"><span>exit
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./tmp_0825_02.sh 
</span></span><span style="display:flex;"><span>the srcipt will exit and <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;</span>$?<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>cat ./tmp_0825_02.sh 
</span></span><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>myfunc<span style="color:#f92672">(){</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;the srcipt will exit and return 2&#34;</span>
</span></span><span style="display:flex;"><span>    exit <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>myfunc
</span></span></code></pre></div><p>如果在函数中执行返回值 可以用 return</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>my_function<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#e6db74">&#34;Inside function&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>my_function
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;Function returned </span>$?<span style="color:#e6db74">&#34;</span>
</span></span></code></pre></div><p>综上，总结来说 退出脚本 exit ， 可以退出的时候选择指定状态码，默认状态码为0，在函数返回值上可以使用 return 然后再带上数字</p>
<h3 id="命令-getopts">命令 getopts</h3>
<blockquote>
<p>注意啊，c语言里面也是有这个函数，同名函数</p>
</blockquote>
<h2 id="shell-测试">shell 测试</h2>
<blockquote>
<p>shell  的测试文件后缀为 .bats</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env bats
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>@test <span style="color:#e6db74">&#34;Check if file exists&#34;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  run test -f <span style="color:#e6db74">&#34;/etc/passwd&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span>$status<span style="color:#e6db74">&#34;</span> -eq <span style="color:#ae81ff">0</span> <span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>@test <span style="color:#e6db74">&#34;Check if string matches&#34;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  result<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;hello&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span>$result<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;hello&#34;</span> <span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>@test <span style="color:#e6db74">&#34;Check the output of a command&#34;</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  run echo <span style="color:#e6db74">&#34;Hello, Bats!&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span>$status<span style="color:#e6db74">&#34;</span> -eq <span style="color:#ae81ff">0</span> <span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span>$output<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Hello, Bats!&#34;</span> <span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 运行结果</span>
</span></span><span style="display:flex;"><span>bats  tmp_0825_01.bats
</span></span><span style="display:flex;"><span> ✓ Check <span style="color:#66d9ef">if</span> file exists
</span></span><span style="display:flex;"><span> ✓ Check <span style="color:#66d9ef">if</span> string matches
</span></span><span style="display:flex;"><span> ✓ Check the output of a command
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span> tests, <span style="color:#ae81ff">0</span> failures
</span></span></code></pre></div><blockquote>
<p><a href="https://github.com/tutuwu2019/hard-study-to-stronger/blob/main/linux/test%E5%91%BD%E4%BB%A4.md">引申</a></p>
</blockquote>

</content>
<p>
  
  <a href="https://tutuwu2019.github.io/blog/linux/">#linux</a>
  
</p>

  </main>
  <footer>contact me  <a href="https://github.com/tutuwu2019/">zhangbuda7788</a>
</footer>

    




</body>

</html>
